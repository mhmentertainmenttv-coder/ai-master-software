<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TWER ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; padding: 20px; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h2 { color: #004d40; text-align: center; }
        
        /* ‡§ü‡•á‡§¨‡§≤ ‡§°‡§ø‡§ú‡§æ‡§á‡§® */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border: 1px solid #ddd; text-align: left; }
        th { background: #004d40; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }

        /* ‡§¨‡§ü‡§® */
        .btn { padding: 5px 10px; color: white; border: none; cursor: pointer; border-radius: 4px; text-decoration: none; font-size: 14px; }
        .view-btn { background: #1a73e8; }
        .del-btn { background: #d93025; }
        
        /* ‡§≤‡•â‡§ó‡§ø‡§® ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® */
        #login-screen { text-align: center; margin-top: 50px; padding: 20px; background: white; max-width: 300px; margin: 50px auto; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        input { padding: 10px; width: 90%; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; }
        .login-btn { padding: 10px 20px; background: #004d40; color: white; border: none; cursor: pointer; border-radius: 5px; width: 100%; font-weight: bold; }
        
        .hidden { display: none; }
        img.preview { width: 50px; height: 50px; object-fit: cover; border-radius: 50%; }
    </style>
</head>
<body>

<div id="login-screen">
    <h2 style="margin-top:0;">üîê ‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®</h2>
    
    <label style="float:left; font-weight:bold; font-size:12px;">User ID:</label>
    <input type="text" id="userId" placeholder="Enter User ID">
    
    <label style="float:left; font-weight:bold; font-size:12px;">Password:</label>
    <input type="password" id="passInput" placeholder="Enter Password">
    
    <button class="login-btn" onclick="checkLogin()">‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç</button>
</div>

<div id="dashboard" class="container hidden">
    <h2>üéì TWER ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ (Admin)</h2>
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <p>‡§ï‡•Å‡§≤ ‡§õ‡§æ‡§§‡•ç‡§∞: <b id="total-count">0</b></p>
        <button onclick="logout()" style="background:red; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer;">Logout</button>
    </div>
    
    <table>
        <thead>
            <tr>
                <th>‡§´‡•ã‡§ü‡•ã</th>
                <th>‡§®‡§æ‡§Æ / ‡§™‡§ø‡§§‡§æ</th>
                <th>‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï (Mobile)</th>
                <th>‡§ï‡•ã‡§∞‡•ç‡§∏</th>
                <th>‡§°‡•â‡§ï‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü</th>
            </tr>
        </thead>
        <tbody id="table-body">
            </tbody>
    </table>
</div>

<script>
    // 1. Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyDiBvD8EBvLjoSebBpJdAW_vVn-EQjeR-k",
        authDomain: "vaiklpikchikitsaparshadbharat.firebaseapp.com",
        databaseURL: "https://vaiklpikchikitsaparshadbharat.firebaseio.com",
        projectId: "vaiklpikchikitsaparshadbharat",
        storageBucket: "vaiklpikchikitsaparshadbharat.firebasestorage.app",
        messagingSenderId: "1079660707444",
        appId: "1:1079660707444:web:c23dbe5e5fe00bb739db21"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 2. ‡§®‡§Ø‡§æ ‡§≤‡•â‡§ó‡§ø‡§® ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ (ID: Twerdata, Pass: 1979)
    function checkLogin() {
        const uid = document.getElementById('userId').value;
        const pass = document.getElementById('passInput').value;
        
        // ‡§Ø‡§π‡§æ‡§Å ‡§ö‡•á‡§ï ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à
        if(uid === "Twerdata" && pass === "1979") {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            loadData(); // ‡§∏‡§π‡•Ä ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç
        } else {
            alert("‚ùå ‡§ó‡§≤‡§§ ID ‡§Ø‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§");
        }
    }

    // 3. ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ
    function loadData() {
        const table = document.getElementById('table-body');
        table.innerHTML = "<tr><td colspan='5'>‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à... ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç</td></tr>"; 
        
        db.ref('students').on('value', (snapshot) => {
            table.innerHTML = ""; // ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§°‡•á‡§ü‡§æ ‡§∏‡§æ‡•û
            let count = 0;

            if(!snapshot.exists()){
                 table.innerHTML = "<tr><td colspan='5'>‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</td></tr>";
                 return;
            }

            snapshot.forEach((child) => {
                const data = child.val();
                count++;
                
                let photoHTML = data.photo ? `<img src="${data.photo}" class="preview" onclick="window.open('${data.photo}')" style="cursor:pointer">` : "No Photo";
                let docHTML = data.document ? `<a href="${data.document}" download="document.png" target="_blank" class="btn view-btn">üìÑ View</a>` : "No Doc";

                const row = `
                    <tr>
                        <td>${photoHTML}</td>
                        <td><b>${data.student_name}</b><br><small>S/o ${data.father_name}</small><br><small style="color:blue">${data.enrollment_no || ''}</small></td>
                        <td>${data.mobile}<br><small>${data.email || ''}</small></td>
                        <td><span style="background:#e0f2f1; padding:2px 5px; border-radius:3px;">${data.course}</span></td>
                        <td>${docHTML}</td>
                    </tr>
                `;
                table.innerHTML += row;
            });
            document.getElementById('total-count').innerText = count;
        });
    }

    function logout() { location.reload(); }
</script>
</body>
</html>
